#
# xorg-nvidia.conf - DevOpsBroker sample /etc/X11/xorg.conf file for NVIDIA video cards
#
# Copyright (C) 2018 Edward Smith <edwardsmith@devopsbroker.org>
#
# This program is free software: you can redistribute it and/or modify it under
# the terms of the GNU General Public License as published by the Free Software
# Foundation, either version 3 of the License, or (at your option) any later
# version.
#
# This program is distributed in the hope that it will be useful, but WITHOUT
# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
# FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more
# details.
#
# You should have received a copy of the GNU General Public License along with
# this program.  If not, see <http://www.gnu.org/licenses/>.
#
# -----------------------------------------------------------------------------
# Developed on Ubuntu 16.04.4 LTS running kernel.osrelease = 4.13.0-43
#
# nvidia-settings: X configuration file generated by nvidia-settings
# nvidia-settings: version 390.87 Tue Aug 21 17:32:26 PDT 2018
#
# NOTE: If you have issues with X11 freezing on startup, remove the
# ForceCompositionPipeline option and restart.
#
# Useful Linux Command-Line Utilities
# ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
# List loaded Linux Kernel modules
#   o lsmod
#
# View information about a Linux kernel module
#   o modinfo nvidia
#
# View existing configured display modes
#   o xrandr --current
#
# View information about all recognized NVIDIA GPUs in the system
#   o nvidia-xconfig --query-gpu-info
#
# Verify direct rendering is enabled (GPU Performance)
#   o glxinfo | grep -F "direct rendering"
#
# Configure the NVIDIA graphics driver
#   o nvidia-settings
#
# TODO: Cannot get the computed DPI found in /var/log/Xorg.0.log synched up
#       with the value reported from:
#
# xrdb -query | grep dpi
#
# xdpyinfo
# -----------------------------------------------------------------------------
#

Section "ServerLayout"
	Identifier     "UbuntuDesktop"
	Screen      0  "Screen0" 0 0
	InputDevice    "USB Keyboard" "CoreKeyboard"
	InputDevice    "USB Mouse" "CorePointer"
	Option         "Xinerama" "0"
EndSection

Section "Files"
EndSection

Section "Module"
	Load           "freetype"
	Load           "glx"
	Load           "type1"
EndSection

Section "InputDevice"
	Identifier     "USB Mouse"
	Driver         "mouse"
	Option         "Protocol" "USB"
	Option         "Device" "/dev/input/mice"
	Option         "Buttons" "7"
	Option         "ButtonsMapping" "1 2 3 6 7"
	Option         "Resolution" "1500"
	Option         "SampleRate" "500"
	Option         "ZAxisMapping" "4 5"
EndSection

Section "InputDevice"
	Identifier     "USB Keyboard"
	Driver         "kbd"
	Option         "XkbLayout" "us"
EndSection

Section "Monitor"
	# HorizSync source: edid, VertRefresh source: edid
	Identifier     "Monitor0"
	VendorName     "LG Electronics"
	ModelName      "LG 34CB88-P 34-inch Ultrawide"
	HorizSync       30.0 - 90.0
	VertRefresh     56.0 - 61.0
	Option         "DPMS"
EndSection

Section "Device"
	Identifier     "Device0"
	Driver         "nvidia"
	VendorName     "NVIDIA Corporation"
	BoardName      "GeForce GT 1030"
	Option         "DPI" "109 x 109"
EndSection

Section "Screen"
	Identifier     "Screen0"
	Device         "Device0"
	Monitor        "Monitor0"
	DefaultDepth    24
	Option         "Accel" "On"
	Option         "AddARGBGLXVisuals" "True"
	Option         "AllowGLXWithComposite" "True"
	Option         "AllowSHMPixmaps" "False"
	Option         "BaseMosaic" "Off"
	Option         "ColorSpace" "RGB"
	Option         "ColorRange" "Full"
	Option         "DamageEvents" "On"
	Option         "ForceCompositionPipeline" "On"
	Option         "GLShaderDiskCache" "On"
	Option         "Interactive" "Off"
	Option         "metamodes" "nvidia-auto-select +0+0"
	Option         "MultiGPU" "Off"
	Option         "MultisampleCompatibility" "True"
	Option         "NoFlip" "False"
	Option         "nvidiaXineramaInfoOrder" "DFP-2"
	Option         "RenderAccel" "True"
	Option         "SLI" "Off"
	Option         "ThermalConfigurationCheck" "On"
	Option         "TripleBuffer" "On"
	Option         "UseEDID" "True"
	Option         "UseEDIDDpi" "False"
	SubSection     "Display"
		Depth       24
	EndSubSection
EndSection

Section "Extensions"
	Option         "Composite" "Enable"
EndSection
